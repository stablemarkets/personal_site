Yw = rgamma(n, shape = y_shape, scale = y_scale)
if(is.null(interv)){
return(data.frame( L[,-1] , A , W , Yw , delta ) )
}else{
return(mean( W*1 - Yw ) )
}
}
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
d = sim_data(n=2000, tau=20)
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
sim_data = function(n=500, interv=NULL, tau){
L = cbind(1, L1 = rbinom(n, 1, .5), L2=rbinom(n, 1,.5), L3=rnorm(n), L4=rnorm(n))
if(!is.null(interv)){
A = rep(interv, n)
tau = 20
}else{
beta_a = c(0, .1, -1., .1, -.1)
A = rbinom(n, 1, invlogit( L %*% beta_a   )  )
tau = 20
}
beta_t = c(2.5, .5, -.1, .1, -.1)
time_mu = exp(  L %*% beta_t + .1*A )
time_phi = 2
time = rgamma(n, shape = (time_mu^2)/time_phi, scale = time_phi/time_mu )
rst = pmin(time, tau)
cen_mu = exp(.09 +  L %*% beta_t + .1*A )
cen_phi = 2
cen = rgamma(n, shape = (cen_mu^2)/cen_phi, scale = cen_phi/cen_mu )
if(!is.null(interv)){
cen=Inf
}
W = pmin(rst, cen)
delta = 1*(rst<cen)
#W= pmin(time, cen)
#delta = 1*(time<cen)
beta_y = c(0, .1,-.1, .1, -.1)
y_shape = (W/2)^2
y_scale = exp( -.5*A + L %*% beta_y - .2 * L[,2] * L[,4] )
Yw = rgamma(n, shape = y_shape, scale = y_scale)
if(is.null(interv)){
return(data.frame( L[,-1] , A , W , Yw , delta ) )
}else{
return(mean( W*1 - Yw ) )
}
}
d = sim_data(n=2000, tau=20)
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
sim_data = function(n=500, interv=NULL, tau){
L = cbind(1, L1 = rbinom(n, 1, .5), L2=rbinom(n, 1,.5), L3=rnorm(n), L4=rnorm(n))
if(!is.null(interv)){
A = rep(interv, n)
tau = 20
}else{
beta_a = c(0, .1, -1., .1, -.1)
A = rbinom(n, 1, invlogit( L %*% beta_a   )  )
tau = 20
}
beta_t = c(2.5, .5, -.1, .1, -.1)
time_mu = exp(  L %*% beta_t + .1*A )
time_phi = 2
time = rgamma(n, shape = (time_mu^2)/time_phi, scale = time_phi/time_mu )
rst = pmin(time, tau)
cen_mu = exp(.09 +  L %*% beta_t + .1*A )
cen_phi = 2
cen = rgamma(n, shape = (cen_mu^2)/cen_phi, scale = cen_phi/cen_mu )
if(!is.null(interv)){
cen=Inf
}
W = pmin(rst, cen)
delta = 1*(rst<cen)
#W= pmin(time, cen)
#delta = 1*(time<cen)
beta_y = c(0, .1,-.1, .1, -.1)
y_shape = (W/2)^2
y_scale = exp( -.5*A + L %*% beta_y - .2 * L[,2] * L[,4] +.2*L[,2] * L[,3] )
Yw = rgamma(n, shape = y_shape, scale = y_scale)
if(is.null(interv)){
return(data.frame( L[,-1] , A , W , Yw , delta ) )
}else{
return(mean( W*1 - Yw ) )
}
}
d = sim_data(n=2000, tau=20)
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
plot(d$W , d$Yw )
plot(d$W , d$Yw )
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
sim_data = function(n=500, interv=NULL, tau){
L = cbind(1, L1 = rbinom(n, 1, .5), L2=rbinom(n, 1,.5), L3=rnorm(n), L4=rnorm(n))
if(!is.null(interv)){
A = rep(interv, n)
tau = 20
}else{
beta_a = c(0, .1, -1., .1, -.1)
A = rbinom(n, 1, invlogit( L %*% beta_a   )  )
tau = 20
}
beta_t = c(2.5, .5, -.1, .1, -.1)
time_mu = exp(  L %*% beta_t + .1*A )
time_phi = 2
time = rgamma(n, shape = (time_mu^2)/time_phi, scale = time_phi/time_mu )
rst = pmin(time, tau)
cen_mu = exp(.09 +  L %*% beta_t + .1*A + - .2 * L[,2] * L[,4] +.2*L[,2] * L[,3]  )
cen_phi = 2
cen = rgamma(n, shape = (cen_mu^2)/cen_phi, scale = cen_phi/cen_mu )
if(!is.null(interv)){
cen=Inf
}
W = pmin(rst, cen)
delta = 1*(rst<cen)
#W= pmin(time, cen)
#delta = 1*(time<cen)
beta_y = c(0, .1,-.1, .1, -.1)
y_shape = (W/2)^2
y_scale = exp( -.5*A + L %*% beta_y - .2 * L[,2] * L[,4] +.2*L[,2] * L[,3] )
Yw = rgamma(n, shape = y_shape, scale = y_scale)
if(is.null(interv)){
return(data.frame( L[,-1] , A , W , Yw , delta ) )
}else{
return(mean( W*1 - Yw ) )
}
}
d = sim_data(n=2000, tau=20)
plot(d$W , d$Yw )
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
plot(log(d$W) , log(d$Yw) )
plot(d$L4, d$W, col=ifelse(d$L1==1,'red','black'))
sim_data = function(n=500, interv=NULL, tau){
L = cbind(1, L1 = rbinom(n, 1, .5), L2=rbinom(n, 1,.5), L3=rnorm(n), L4=rnorm(n))
if(!is.null(interv)){
A = rep(interv, n)
tau = 18
}else{
beta_a = c(0, .1, -1., .1, -.1)
A = rbinom(n, 1, invlogit( L %*% beta_a   )  )
tau = Inf
}
beta_t = c(2.5, .5, -.1, .1, -.1)
time_mu = exp(  L %*% beta_t + .1*A )
time_phi = 2
time = rgamma(n, shape = (time_mu^2)/time_phi, scale = time_phi/time_mu )
rst = pmin(time, tau)
cen_mu = exp(.09 +  L %*% beta_t + .1*A + - .2 * L[,2] * L[,4] +.2*L[,2] * L[,3]  )
cen_phi = 2
cen = rgamma(n, shape = (cen_mu^2)/cen_phi, scale = cen_phi/cen_mu )
if(!is.null(interv)){
cen=Inf
}
W = pmin(rst, cen)
delta = 1*(rst<cen)
#W= pmin(time, cen)
#delta = 1*(time<cen)
beta_y = c(0, .1,-.1, .1, -.1)
y_shape = (W/2)^2
y_scale = exp( -.5*A + L %*% beta_y - .2 * L[,2] * L[,4] +.2*L[,2] * L[,3] )
Yw = rgamma(n, shape = y_shape, scale = y_scale)
if(is.null(interv)){
return(data.frame( L[,-1] , A , W , Yw , delta ) )
}else{
return(mean( W*1 - Yw ) )
}
}
d = sim_data(n=2000, tau=20)
plot(d$W , d$Yw )
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
plot(d$L4, d$W, col=ifelse(d$L1==1,'red','black'))
plot(d$L3, d$W, col=ifelse(d$L1==1,'red','black'))
sim_data = function(n=500, interv=NULL, tau){
L = cbind(1, L1 = rbinom(n, 1, .5), L2=rbinom(n, 1,.5), L3=rnorm(n), L4=rnorm(n))
if(!is.null(interv)){
A = rep(interv, n)
tau = 18
}else{
beta_a = c(0, .1, -1., .1, -.1)
A = rbinom(n, 1, invlogit( L %*% beta_a   )  )
tau = Inf
}
beta_t = c(2.5, .5, -.1, .1, -.1)
time_mu = exp(  L %*% beta_t + .1*A )
time_phi = 2
time = rgamma(n, shape = (time_mu^2)/time_phi, scale = time_phi/time_mu )
rst = pmin(time, tau)
cen_mu = exp(.09 +  L %*% beta_t + .1*A + - .2 * L[,2] * L[,4] +.2*L[,2] * L[,3]  )
cen_phi = 2
cen = rgamma(n, shape = (cen_mu^2)/cen_phi, scale = cen_phi/cen_mu )
if(!is.null(interv)){
cen=Inf
}
W = pmin(rst, cen)
delta = 1*(rst<cen)
#W= pmin(time, cen)
#delta = 1*(time<cen)
beta_y = c(0, .1,-.1, .1, -.1)
y_shape = (W/2)^2
y_scale = exp( -.5*A + L %*% beta_y - .2 * L[,2] * L[,4] +.2*L[,2] * L[,3] )
Yw = rgamma(n, shape = y_shape, scale = y_scale)
if(is.null(interv)){
return(data.frame( L[,-1] , A , W , Yw , delta ) )
}else{
return(mean( W*1 - Yw ) )
}
}
d = sim_data(n=2000, tau=20)
plot(d$W , d$Yw )
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
plot(d$L4, d$W, col=ifelse(d$L1==1,'red','black'))
plot(d$L3, d$W, col=ifelse(d$L1==1,'red','black'))
sim_data = function(n=500, interv=NULL, tau){
L = cbind(1, L1 = rbinom(n, 1, .5), L2=rbinom(n, 1,.5), L3=rnorm(n), L4=rnorm(n))
if(!is.null(interv)){
A = rep(interv, n)
tau = 18
}else{
beta_a = c(0, .1, -1., .1, -.1)
A = rbinom(n, 1, invlogit( L %*% beta_a   )  )
tau = Inf
}
beta_t = c(2.5, .5, -.1, .1, -.1)
time_mu = exp(  L %*% beta_t + .1*A )
time_phi = 2
time = rgamma(n, shape = (time_mu^2)/time_phi, scale = time_phi/time_mu )
rst = pmin(time, tau)
cen_mu = exp(.09 +  L %*% beta_t + .1*A + - 1 * L[,2] * L[,4] + 1*L[,2] * L[,3]  )
cen_phi = 2
cen = rgamma(n, shape = (cen_mu^2)/cen_phi, scale = cen_phi/cen_mu )
if(!is.null(interv)){
cen=Inf
}
W = pmin(rst, cen)
delta = 1*(rst<cen)
#W= pmin(time, cen)
#delta = 1*(time<cen)
beta_y = c(0, .1,-.1, .1, -.1)
y_shape = (W/2)^2
y_scale = exp( -.5*A + L %*% beta_y - .2 * L[,2] * L[,4] +.2*L[,2] * L[,3] )
Yw = rgamma(n, shape = y_shape, scale = y_scale)
if(is.null(interv)){
return(data.frame( L[,-1] , A , W , Yw , delta ) )
}else{
return(mean( W*1 - Yw ) )
}
}
d = sim_data(n=2000, tau=20)
plot(d$W , d$Yw )
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
plot(d$L4, d$W, col=ifelse(d$L1==1,'red','black'))
plot(d$L3, d$W, col=ifelse(d$L1==1,'red','black'))
d = sim_data(n=2000, tau=20)
truth = sim_data(1000000,tau=18, interv = 1) - sim_data(1000000,tau=18, interv = 0)
truth
plot(d$W , d$Yw )
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
plot(d$L4, d$W, col=ifelse(d$L1==1,'red','black'))
plot(d$L3, d$W, col=ifelse(d$L1==1,'red','black'))
xt = cbind(1, d$A, d$L1, d$L2, d$L3, d$L4)
xy = cbind(1, d$A, log(d$W), d$L1, d$L2, d$L3, d$L4)
res = cea_mcmc(d, xt = xt, xy = xy, dct = log(d$W), dcy = log(d$Yw), delta = d$delta,
xy_test = xy_test, xt_test = xt_test, t_test = t_test,
tau=18, iter =  2000, burnin = 1000, thin = 1)
d = sim_data(n=300, tau=20)
plot(d$W , d$Yw )
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
plot(d$L4, d$W, col=ifelse(d$L1==1,'red','black'))
plot(d$L3, d$W, col=ifelse(d$L1==1,'red','black'))
xt = cbind(1, d$A, d$L1, d$L2, d$L3, d$L4)
xy = cbind(1, d$A, log(d$W), d$L1, d$L2, d$L3, d$L4)
xy_test = cbind( 1, A = 0,
W = log(seq(.01, 20,  length.out=100)),
L1 = 0,
L2 = 1,
L3=mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
xt_test = cbind( rep(1,100), A = 0,
L1 = 0,
L2 = 1,
L3 = mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
t_test = log(seq(.01, 20,  length.out=100))
res = cea_mcmc(d, xt = xt, xy = xy, dct = log(d$W), dcy = log(d$Yw), delta = d$delta,
xy_test = xy_test, xt_test = xt_test, t_test = t_test,
tau=18, iter =  2000, burnin = 1000, thin = 1)
nmb_post = cea_gcomp(res, cbind(d$L1, d$L2, d$L3, d$L4), 18, 1)
hist(nmb_post[nmb_post<1000 & nmb_post>-1000], breaks=50)
hist(nmb_post, breaks=50)
nmb_post
res
nmb_post = cea_gcomp(res, cbind(d$L1, d$L2, d$L3, d$L4), 18, 1)
plot(d$W, d$Yw,
col=ifelse(d$A==0 & d$L1==0 & d$L2==1, 'red', 'gray'),
pch=20, ylim=c(0, 200), xlim=c(8,20) )
preds = res$cond_mean_y_test
credible_gradient( seq(0, 20,  length.out=100)[-1*c(1:40)],
post_draws = preds[-1*c(1:40),] )
d = sim_data(n=300, tau=20)
truth = sim_data(1000000,tau=18, interv = 1) - sim_data(1000000,tau=18, interv = 0)
truth
plot(d$W , d$Yw )
plot(d$L4, d$Yw, col=ifelse(d$L1==1,'red','black'))
plot(d$L4, d$W, col=ifelse(d$L1==1,'red','black'))
plot(d$L3, d$W, col=ifelse(d$L1==1,'red','black'))
xt = cbind(1, d$A, d$L1, d$L2, d$L3, d$L4)
xy = cbind(1, d$A, log(d$W), d$L1, d$L2, d$L3, d$L4)
xy_test = cbind( 1, A = 0,
W = log(seq(.01, 20,  length.out=100)),
L1 = 0,
L2 = 1,
L3=mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
xt_test = cbind( rep(1,100), A = 0,
L1 = 0,
L2 = 1,
L3 = mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
t_test = log(seq(.01, 20,  length.out=100))
res = cea_mcmc(d, xt = xt, xy = xy, dct = log(d$W), dcy = log(d$Yw), delta = d$delta,
xy_test = xy_test, xt_test = xt_test, t_test = t_test,
tau=18, iter =  2000, burnin = 1000, thin = 1)
nmb_post = cea_gcomp(res, cbind(d$L1, d$L2, d$L3, d$L4), 18, 1)
plot(d$W, d$Yw,
col=ifelse(d$A==0 & d$L1==0 & d$L2==1, 'red', 'gray'),
pch=20, ylim=c(0, 200), xlim=c(8,20) )
preds = res$cond_mean_y_test
credible_gradient( seq(0, 20,  length.out=100)[-1*c(1:40)],
post_draws = preds[-1*c(1:40),] )
points(d$W, d$Yw,
col=ifelse(d$A==0 & d$L1==0 & d$L2==1, 'red', 'gray'),
pch=20, ylim=c(0, 200), xlim=c(5,20) )
hist(nmb_post, breaks=50)
hist(nmb_post[nmb_post<1000 & nmb_post>-1000], breaks=50)
hist(nmb_post[nmb_post<50 & nmb_post>-10], breaks=50)
hist(nmb_post[nmb_post<100 & nmb_post>-10], breaks=50)
abline(v=truth, col='red')
d = sim_data(n=600, tau=20)
xt = cbind(1, d$A, d$L1, d$L2, d$L3, d$L4)
xy = cbind(1, d$A, log(d$W), d$L1, d$L2, d$L3, d$L4)
xy_test = cbind( 1, A = 0,
W = log(seq(.01, 20,  length.out=100)),
L1 = 0,
L2 = 1,
L3=mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
xt_test = cbind( rep(1,100), A = 0,
L1 = 0,
L2 = 1,
L3 = mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
t_test = log(seq(.01, 20,  length.out=100))
res = cea_mcmc(d, xt = xt, xy = xy, dct = log(d$W), dcy = log(d$Yw), delta = d$delta,
xy_test = xy_test, xt_test = xt_test, t_test = t_test,
tau=18, iter =  2000, burnin = 1000, thin = 1)
nmb_post = cea_gcomp(res, cbind(d$L1, d$L2, d$L3, d$L4), 18, 1)
hist(nmb_post[nmb_post<1000 & nmb_post>-1000], breaks=50)
hist(nmb_post[nmb_post<100 & nmb_post>-10], breaks=50)
hist(nmb_post, breaks=50)
abline(v=truth, col='red')
hist(nmb_post[nmb_post<100 & nmb_post>-10], breaks=50)
hist(nmb_post[nmb_post<1000 & nmb_post>-1000], breaks=50)
nmb_post
sim_data = function(n=500, interv=NULL, tau){
L = cbind(1, L1 = rbinom(n, 1, .5), L2=rbinom(n, 1,.5), L3=rnorm(n), L4=rnorm(n))
if(!is.null(interv)){
A = rep(interv, n)
tau = 18
}else{
beta_a = c(0, .1, -1., .1, -.1)
A = rbinom(n, 1, invlogit( L %*% beta_a   )  )
tau = Inf
}
beta_t = c(2.5, .5, -.1, .1, -.1)
time_mu = exp(  L %*% beta_t + .1*A )
time_phi = 2
time = rgamma(n, shape = (time_mu^2)/time_phi, scale = time_phi/time_mu )
rst = pmin(time, tau)
cen_mu = exp(.09 +  L %*% beta_t + .1*A + - 1 * L[,2] * L[,4] + 1*L[,2] * L[,3]  )
cen_phi = 2
cen = rgamma(n, shape = (cen_mu^2)/cen_phi, scale = cen_phi/cen_mu )
if(!is.null(interv)){
cen=Inf
}
W = pmin(rst, cen)
delta = 1*(rst<cen)
#W= pmin(time, cen)
#delta = 1*(time<cen)
beta_y = c(0, .1,-.1, .1, -.1)
y_shape = (W/2)^2
y_scale = exp( -.5*A + L %*% beta_y - .2 * L[,2] * L[,4] +.2*L[,2] * L[,3] )
Yw = rgamma(n, shape = y_shape, scale = y_scale)
if(is.null(interv)){
return(data.frame( L[,-1] , A , W , Yw , delta ) )
}else{
return(mean( W*1 - Yw ) )
}
}
d = sim_data(n=600, tau=20)
truth = sim_data(1000000,tau=18, interv = 1) - sim_data(1000000,tau=18, interv = 0)
xy_test = cbind( 1, A = 0,
W = log(seq(.01, 20,  length.out=100)),
L1 = 0,
L2 = 1,
L3=mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
xt_test = cbind( rep(1,100), A = 0,
L1 = 0,
L2 = 1,
L3 = mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
xt = cbind(1, d$A, d$L1, d$L2, d$L3, d$L4)
xy = cbind(1, d$A, log(d$W), d$L1, d$L2, d$L3, d$L4)
xy_test = cbind( 1, A = 0,
W = log(seq(.01, 20,  length.out=100)),
L1 = 0,
L2 = 1,
L3=mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
xt_test = cbind( rep(1,100), A = 0,
L1 = 0,
L2 = 1,
L3 = mean(d$L3[d$A==0 & d$L1==0 & d$L2==1]),
L4 = mean(d$L4[d$A==0 & d$L1==0 & d$L2==1]) )
t_test = log(seq(.01, 20,  length.out=100))
res = cea_mcmc(d, xt = xt, xy = xy, dct = log(d$W), dcy = log(d$Yw), delta = d$delta,
xy_test = xy_test, xt_test = xt_test, t_test = t_test,
tau=18, iter =  2000, burnin = 1000, thin = 1)
nmb_post = cea_gcomp(res, cbind(d$L1, d$L2, d$L3, d$L4), 18, 1)
hist(nmb_post, breaks=50)
hist(nmb_post[nmb_post<100 & nmb_post>-10], breaks=50)
abline(v=truth, col='red')
hist(rnorm(1000))
hist(exp(rnorm(1000)))
hist(exp(rnorm(1000,1, 5)))
datasets::airmiles
tt = datasets::airmiles
tt = datasets::cars
View(tt)
tt = survival::aml
View(tt)
tt = survival::bladder
View(tt)
?survival::bladder
d = survival::bladder
d_sub = d[,c('id','treatment','recur')]
d = survival::bladder
d_sub = d[,c('id','treatment','recur')]
View(d)
d = survival::bladder1
View(d)
d_sub = d[,c('id','treatment','recur')]
View(d_sub)
View(d_sub)
d_sub = d_sub[d_sub$treatment %in% c('Placebo','pyridoxine')]
d_sub = d_sub[d_sub$treatment %in% c('Placebo','pyridoxine'),]
View(d_sub)
d_sub = d_sub[d_sub$treatment %in% c('placebo','pyridoxine'),]
d_sub = d[,c('id','treatment','recur')]
d_sub = d_sub[d_sub$treatment %in% c('placebo','pyridoxine'),]
View(d_sub)
tapply(d_sub$recur, d_sub$treatment, mean )
glm_res = glm(data=d_sub,
formula = recur ~ treatment,
family=poisson(link = 'log'))
summary(glm_res)
exp(1.26827)
exp(0.26289)
tapply(d_sub$recur, d_sub$treatment, mean )
tapply(d_sub$recur, d_sub$treatment, mean )
d_sub$treatment = ifelse(d_sub$treatment=='placebo',0,1)
d = survival::bladder1
d_sub = d[,c('id','treatment','recur')]
d_sub$treatment = ifelse(d_sub$treatment=='placebo',0,1)
d_sub = d_sub[d_sub$treatment %in% c('placebo','pyridoxine'),]
tapply(d_sub$recur, d_sub$treatment, mean )
View(d_sub)
d = survival::bladder1
d_sub = d[,c('id','treatment','recur')]
View(d_sub)
d_sub = d_sub[d_sub$treatment %in% c('placebo','pyridoxine'),]
d_sub$treatment = ifelse(d_sub$treatment=='placebo',0,1)
View(d_sub)
tapply(d_sub$recur, d_sub$treatment, mean )
4.623529 / 3.554688
glm_res = glm(data=d_sub,
formula = recur ~ treatment,
family=poisson(link = 'log'))
summary(glm_res)
exp(glm_res$coefficients[1])
tapply(d_sub$recur, d_sub$treatment, mean )
exp(exp(glm_res$coefficients[2]))
4.623529 / 3.554688
exp(glm_res$coefficients[2])
d = survival::bladder1
d = survival::bladder1
View(d)
d_sub = d[,c('id','treatment','recur')]
d_sub = d_sub[d_sub$treatment %in% c('placebo','pyridoxine'),]
d_sub$treatment = ifelse(d_sub$treatment=='placebo',0,1)
View(d_sub)
print(d_sub)
tapply(d_sub$recur, d_sub$treatment, mean )
4.623529 / 3.554688
glm_res = glm(data=d_sub,
formula = recur ~ treatment,
family=poisson(link = 'log'))
summary(glm_res)
exp(glm_res$coefficients[1])
exp(glm_res$coefficients[2])
4.623529 / 3.554688
tapply(d_sub$recur, d_sub$treatment, mean )
0.26289/0.06886
2*(1 - pnorm(3.817746, mean=, sd=1))
getwd()
setwd("google_drive/Software/personal_site/")
blogdown::build_site()
